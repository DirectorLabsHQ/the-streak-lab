<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Streak Lab | NBA Heat Sheet</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .heat-high { background-color: #ef4444; color: white; border: 1px solid #7f1d1d; } 
        .heat-med { background-color: #f97316; color: white; } 
        .heat-low { background-color: #334155; color: #94a3b8; }
        .tab-active { border-bottom: 4px solid #f97316; color: #f97316; }
    </style>
</head>
<body class="bg-slate-900 text-white font-sans">

    <div class="max-w-6xl mx-auto py-10 px-4">
        <header class="mb-10 text-center">
            <h1 class="text-5xl font-black tracking-tighter text-white">THE STREAK <span class="text-orange-500">LAB</span></h1>
            <p class="text-slate-400 mt-2 uppercase tracking-widest text-sm">NBA Prop Intelligence for the Sharp Bettor</p>
        </header>

        <section class="mb-12">
            <h2 class="text-orange-500 font-bold uppercase text-xs mb-4 flex items-center gap-2">
                <span class="flex h-2 w-2 rounded-full bg-orange-500 animate-ping"></span> 
                Highest Probability Streaks Today
            </h2>
            <div id="top-picks" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                </div>
        </section>

        <div class="flex gap-6 mb-6 border-b border-slate-800 text-sm font-bold uppercase overflow-x-auto pb-2">
            <button onclick="updateView('pts_heat')" id="tab-pts_heat" class="pb-2 px-2 tab-active">Points</button>
            <button onclick="updateView('reb_heat')" id="tab-reb_heat" class="pb-2 px-2 text-slate-500 hover:text-white">Rebounds</button>
            <button onclick="updateView('ast_heat')" id="tab-ast_heat" class="pb-2 px-2 text-slate-500 hover:text-white">Assists</button>
            <button onclick="updateView('tpm_heat')" id="tab-tpm_heat" class="pb-2 px-2 text-slate-500 hover:text-white">3PM</button>
            <button onclick="updateView('ft_heat')" id="tab-ft_heat" class="pb-2 px-2 text-slate-500 hover:text-white">Free Throws</button>
        </div>

        <div class="bg-slate-800 rounded-2xl shadow-2xl overflow-hidden border border-slate-700">
            <table class="w-full text-left">
                <thead class="bg-slate-900/50 text-slate-500 uppercase text-xs font-black">
                    <tr>
                        <th class="px-6 py-4">Player</th>
                        <th class="px-6 py-4 text-center">Heat Score</th>
                        <th class="px-6 py-4">Last Game Summary</th>
                        <th class="px-6 py-4 text-right">L10 Samples</th>
                    </tr>
                </thead>
                <tbody id="grid-body" class="divide-y divide-slate-700/50 text-sm">
                </tbody>
            </table>
        </div>
    </div>

    <script>
        let playerData = [];
        let currentMetric = 'pts_heat';

        async function loadData() {
            const response = await fetch('streak_data.json');
            const json = await response.json();
            playerData = json.players;
            renderTopPicks();
            renderTable();
        }

        function renderTopPicks() {
            const topArea = document.getElementById('top-picks');
            // Sort by current selected metric to find the 3 best
            const top3 = [...playerData].sort((a, b) => b[currentMetric] - a[currentMetric]).slice(0, 3);
            
            topArea.innerHTML = top3.map(p => `
                <div class="bg-slate-800 p-6 rounded-xl border border-orange-500/30 shadow-lg">
                    <div class="text-xs text-orange-500 font-bold uppercase mb-1">Elite Streak</div>
                    <div class="text-xl font-black">${p.name}</div>
                    <div class="mt-4 flex items-end justify-between">
                        <div class="text-3xl font-black text-white">${p[currentMetric]}%</div>
                        <div class="text-[10px] text-slate-500 text-right uppercase leading-tight">Hit Rate<br>Last 10 Games</div>
                    </div>
                </div>
            `).join('');
        }

        function updateView(metric) {
            document.querySelectorAll('button').forEach(btn => btn.classList.remove('tab-active', 'text-white'));
            document.querySelectorAll('button').forEach(btn => btn.classList.add('text-slate-500'));
            document.getElementById(`tab-${metric}`).classList.add('tab-active', 'text-white');
            currentMetric = metric;
            renderTopPicks();
            renderTable();
        }

        function renderTable() {
            const body = document.getElementById('grid-body');
            const sorted = [...playerData].sort((a, b) => b[currentMetric] - a[currentMetric]);
            body.innerHTML = sorted.map(p => `
                <tr class="hover:bg-slate-700/30 transition-all">
                    <td class="px-6 py-4 font-bold text-white">${p.name}</td>
                    <td class="px-6 py-4 text-center">
                        <span class="px-3 py-1 rounded font-mono font-black ${p[currentMetric] >= 80 ? 'heat-high' : 'heat-med'}">
                            ${p[currentMetric]}%
                        </span>
                    </td>
                    <td class="px-6 py-4 text-slate-300 font-medium">${p.last_game}</td>
                    <td class="px-6 py-4 text-right font-mono text-xs text-slate-500">${p.consistency}</td>
                </tr>
            `).join('');
        }

        loadData();
    </script>
</body>
</html>
